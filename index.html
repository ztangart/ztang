<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>关键字检索 - 高德地图</title>
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }
    body {
      font-family: "Microsoft YaHei", Arial, sans-serif;
      padding: 20px;
      background-color: #f8f9fa;
    }
    .header {
      text-align: center;
      margin-bottom: 20px;
    }
    .header h1 {
      font-size: 28px;
      color: #333;
    }
    .search-area {
      display: flex;
      gap: 10px;
      justify-content: center;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    #keyword {
      width: 300px;
      padding: 10px;
      font-size: 16px;
      border: 1px solid #ccc;
      border-radius: 4px;
    }
    #search-btn {
      padding: 10px 20px;
      background-color: #0077cc;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      font-size: 16px;
    }
    #search-btn:hover {
      background-color: #005fa3;
    }
    #status {
      text-align: center;
      color: #d93025;
      margin: 10px 0;
      min-height: 20px;
    }
    .content {
      display: flex;
      flex-direction: column;
      gap: 15px;
    }
    #map-container {
      height: 400px;
      border: 1px solid #ddd;
      border-radius: 6px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    #panel {
      max-height: 250px;
      overflow-y: auto;
      padding: 12px;
      border: 1px solid #ddd;
      border-radius: 6px;
      background: white;
      box-shadow: 0 2px 6px rgba(0,0,0,0.05);
    }
    @media (max-width: 600px) {
      #keyword {
        width: 100%;
      }
      .search-area {
        flex-direction: column;
        align-items: center;
      }
    }
  </style>
</head>
<body>
  <div class="header">
    <h1>关键字检索</h1>
  </div>

  <div class="search-area">
    <input type="text" id="keyword" placeholder="请输入地点关键词，例如：北京大学、咖啡厅、地铁站" />
    <button id="search-btn">搜索</button>
  </div>

  <div id="status">正在加载地图...</div>

  <div class="content">
    <div id="map-container"></div>
    <div id="panel">搜索结果将显示在此处</div>
  </div>

  <!-- 引入高德地图 JS API v2.0 -->
  <!-- ⚠️ 请务必替换 YOUR_AMAP_KEY 为你的实际 API Key -->
  <script src="https://webapi.amap.com/maps?v=2.0&key=	da1c084878bdd9a0003e9db6d7f7de88"></script>

  <script>
    let map, placeSearch;
    const statusEl = document.getElementById('status');
    const keywordInput = document.getElementById('keyword');
    const searchBtn = document.getElementById('search-btn');

    // 初始化地图
    map = new AMap.Map('map-container', {
      zoom: 11,
      center: [116.404, 39.915], // 默认北京
      viewMode: '3D'
    });

    // 加载 PlaceSearch 插件
    AMap.plugin('AMap.PlaceSearch', () => {
      placeSearch = new AMap.PlaceSearch({
        city: '全国', // 支持全国搜索
        map: map,
        panel: 'panel',
        pageSize: 10,
        pageIndex: 1,
        citylimit: false // 不限制城市
      });
      statusEl.textContent = '地图与搜索功能已就绪';
      statusEl.style.color = '#0077cc';
    });

    // 执行搜索
    function doSearch() {
      const keyword = keywordInput.value.trim();
      if (!keyword) {
        statusEl.textContent = '请输入搜索关键词';
        statusEl.style.color = '#d93025';
        return;
      }

      if (!placeSearch) {
        statusEl.textContent = '搜索服务尚未加载完成，请稍后再试';
        return;
      }

      statusEl.textContent = `正在搜索 "${keyword}"...`;
      statusEl.style.color = '#555';

      placeSearch.search(keyword, (status, result) => {
        if (status === 'complete') {
          const count = result.poiList?.count || 0;
          statusEl.textContent = `找到 ${count} 个结果`;
          statusEl.style.color = '#0077cc';
        } else if (status === 'no_data') {
          statusEl.textContent = '未找到相关地点';
          statusEl.style.color = '#ff8c00';
          document.getElementById('panel').innerHTML = '<p>没有匹配的结果</p>';
        } else {
          statusEl.textContent = '搜索失败：' + (result?.info || '未知错误');
          statusEl.style.color = '#d93025';
          console.error('高德搜索错误:', result);
        }
      });
    }

    // 绑定事件
    searchBtn.addEventListener('click', doSearch);
    keywordInput.addEventListener('keypress', (e) => {
      if (e.key === 'Enter') doSearch();
    });
  </script>
</body>
</html>